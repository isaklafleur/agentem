<div id="filterSearchCard">
  <form #myForm="ngForm" class="example-form">
    <md-input-container>
      <!--      <input [formControl]="searchControl" type="text" autocorrect="off" autocapitalize="off" spellcheck="off" #addressSearchBox [(ngModel)]="newSearch.address" id="addressSearchBox" name="address" (click)="this.addressSearchBox.value = ''" mdInput placeholder="Search by Street, Neighborhood or City"
        value="Copacabana, Rio de Janeiro, RJ">-->
      <input places-auto-complete type="text" autocorrect="off" autocapitalize="off" spellcheck="off" #addressSearchBox [(ngModel)]="newSearch.address"
        id="addressSearchBox" name="address" (click)="this.addressSearchBox.value = ''" mdInput placeholder="Search by Street, Neighborhood or City"
        (place_changed)="placeChanged($event)" 
        [types]="['geocode']" />

    </md-input-container>

    <ng-template #typesBRN>
      <md-radio-group class="example-radio-group" name="typesBRN" (change)="listingService.updateFilter()" (click)="$event.stopPropagation()"
        [(ngModel)]="newSearch.typesBRN">
        <md-radio-button class="example-radio-button" value="sale">
          Buy
        </md-radio-button>
        <md-radio-button class="example-radio-button" value="rental">
          Rent
        </md-radio-button>
        <md-radio-button class="example-radio-button" value="new">
          New Development
        </md-radio-button>
      </md-radio-group>
    </ng-template>
    <button md-raised-button placement="bottom" #p4="ngbPopover" (document:click)="p4.close()" (click)="$event.stopPropagation();p1.close();p2.close();p3.close()"
      [ngbPopover]="typesBRN">Type <i class="material-icons">expand_more</i>
    </button>


    <ng-template #priceRange>
        <table class="example-full-width" cellspacing="0" (click)="$event.stopPropagation()">
          <tr>
            <td>
              <md-input-container class="example-full-width">
                <input mdInput placeholder="Min Price" [(ngModel)]="newSearch.minPrice" [formControl]="minPriceControl" pattern="\d+" name="minPrice">
                <md-error>Please enter number</md-error>
              </md-input-container>
            </td>
            <td>
              <md-input-container class="example-full-width">
                <input mdInput placeholder="Max Price" [(ngModel)]="newSearch.maxPrice" [formControl]="maxPriceControl" pattern="\d+" name="maxPrice">
                <md-error>Please enter number</md-error>
              </md-input-container>
            </td>
          </tr>
        </table>
    </ng-template>

    <button md-raised-button placement="bottom" #p1="ngbPopover" (document:click)="p1.close()" (click)="$event.stopPropagation();p2.close();p3.close();p4.close()"
      [ngbPopover]="priceRange">Any Price <i class="material-icons">expand_more</i>

    </button>

    <ng-template #beds>
      <md-radio-group class="example-radio-group" name="bedrooms" (change)="listingService.updateFilter()" (click)="$event.stopPropagation()"
        [(ngModel)]="newSearch.bedrooms">
        <md-radio-button class="example-radio-button" value="0">
          Studio+
        </md-radio-button>
        <md-radio-button class="example-radio-button" value="1">
          1+
        </md-radio-button>
        <md-radio-button class="example-radio-button" value="2">
          2+
        </md-radio-button>
        <md-radio-button class="example-radio-button" value="3">
          3+
        </md-radio-button>
        <md-radio-button class="example-radio-button" value="4">
          4+
        </md-radio-button>
      </md-radio-group>
    </ng-template>
    <button md-raised-button placement="bottom" #p2="ngbPopover" (document:click)="p2.close()" (click)="$event.stopPropagation();p1.close();p3.close();p4.close()"
      [ngbPopover]="beds">All Beds <i class="material-icons">expand_more</i>
    </button>
    <ng-template #propertyType>
      <section class="example-section" (click)="$event.stopPropagation()">
        <md-checkbox class="example-margin" name="apartment" (change)="listingService.updateFilter()" [(ngModel)]="newSearch.propertyType.apartment">Apartment</md-checkbox>
        <md-checkbox class="example-margin" name="house" (change)="listingService.updateFilter()" [(ngModel)]="newSearch.propertyType.house">House</md-checkbox>
        <md-checkbox class="example-margin" name="villa" (change)="listingService.updateFilter()" [(ngModel)]="newSearch.propertyType.villa">Villa</md-checkbox>
      </section>

    </ng-template>
    <button md-raised-button placement="bottom" #p3="ngbPopover" (document:click)="p3.close()" (click)="$event.stopPropagation();p1.close();p2.close();p4.close()"
      [ngbPopover]="propertyType">All Home Types <i class="material-icons">expand_more</i>
    </button>

    <button md-raised-button color="primary">Search <i class="material-icons">search</i></button> Found: {{listingService.listingCount}}
    matches
    <div *ngIf="listingService.isLoading" style="float:right; padding-top:10px">
      <i class="fa fa-cog fa-spin fa-2x fa-fw spin-cog"></i>
    </div>
  </form>
</div>